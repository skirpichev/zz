\input texinfo @c -*-texinfo-*-
@setfilename zz.info
@settitle C library for arbitrary precision arithmetic on integers
@finalout

@dircategory Scientific software
@direntry
* zz: (zz).                   ZZ, wrapper for the GNU GMP
@end direntry

@set UPDATED 17 Feb 2026
@set EDITION 0.9.0a3
@set VERSION 0.9.0a3

@iftex
@copying
Copyright @copyright{} 2024-2025 Sergey B Kirpichev.

Permission is granted to copy, distribute and/or modify this document under the
terms of the GNU Free Documentation License, Version 1.3; with no Invariant
Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license
is included in the section entitled "GNU Free Documentation License".
@end copying
@end iftex

@ifnottex
@macro bmod
mod
@end macro
@end ifnottex

@titlepage
@title The ZZ Library
@subtitle a tiny wrapper for the GNU GMP Library
@subtitle Version @value{VERSION}
@subtitle @value{UPDATED}

@author Sergey B Kirpichev
@email{skirpichev@@gmail.com}
@page
@vskip 0pt plus 1filll
@insertcopying
@end titlepage

@contents

@ifnottex
@node Top, Introduction, (dir), (dir)
@top ZZ

This manual describes how to install and use the ZZ library,
version @value{VERSION}.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License.
@end ifnottex

@menu
* Introduction::
* Functions::
* References::
* GNU Free Documentation License::
* Function Index::
* Variable Index::
* Type Index::
* Concept Index::
@end menu

@c  @m{T,N} is $T$ in tex or @math{N} otherwise.  Commas in N or T don't work,
@c  but @C{} can be used instead.
@iftex
@macro m {T,N}
@tex$\T\$@end tex
@end macro
@end iftex
@ifnottex
@macro m {T,N}
@math{\N\}
@end macro
@end ifnottex

@node  Introduction, Functions, Top, Top
@chapter Introduction

Library functions and structures are declared in the header file @file{zz.h}.
Names of public functions and structures are beginning with @code{zz_}.  The
data type for big integers is @code{zz_t}.

If function might fail, it has the @code{zz_err} as returned type.  Following
return codes are supported and should be expected from any such function,
unless otherwise stated:

@itemize @bullet
@item @code{ZZ_OK}: The function succeeded.
@item @code{ZZ_MEM}: Heap memory exhausted.
@item @code{ZZ_VAL}: The function argument was invalid.
@item @code{ZZ_BUF}: Buffer overflow, supplied buffer too small.
@end itemize

The same variable could be used for both input and output in one function call.

Please note, that the GNU GMP library must be compiled with the
@option{--disable-alloca} configure option to prevent using alloca() for temporary
workspace allocation.

@node Functions, References, Introduction, Top
@chapter Functions

@menu
* Library Setup::
* Initializing Integers::
* Assigning Integers::
* Converting Integers::
* Arithmetics on Integers::
* Exponentiation::
* Comparison Functions::
* Logical Functions::
* Number Theoretic Functions::
* Combinatorics::
* Import and Export::
* Miscellaneous Functions::
@end menu

@node Library Setup, Initializing Integers, Functions, Functions
@section Library Setup
@cindex Library setup functions
@cindex Library setup

@deftypefun zz_err zz_setup (void)
Initialize the library.  Must be called before all other its functions.
Return @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun void zz_finish (void)
Must be called last.
@end deftypefun

@node Initializing Integers, Assigning Integers, Library Setup, Functions
@section Initialization
@cindex Integer initialization functions
@cindex Initialization functions

@deftypefun zz_err zz_init (zz_t *@var{u})
Initialize @var{u} and set its value to 0.  Return @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun void zz_clear (zz_t *@var{u})
Free the space occupied by @var{u} and set its value to 0.
@end deftypefun

@node Assigning Integers, Converting Integers, Initializing Integers, Functions
@section Assignment
@cindex Integer assignment functions
@cindex Assignment functions

@deftypefun zz_err zz_set_i32 (int32_t @var{u}, zz_t *@var{v})
@deftypefunx zz_err zz_set_i64 (int64_t @var{u}, zz_t *@var{v})
@deftypefunx zz_err zz_set_u64 (uint64_t @var{u}, zz_t *@var{v})
@deftypefunx zz_err zz_set_double (double @var{u}, zz_t *@var{v})
Set @var{u} from @var{v}.  Available as @code{zz_set} macro.

NaNs aren't acceptable in assignment from double, @code{ZZ_BUF} will be
returned for infinities.

Assignments from integer types return only @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_set_str (const char *@var{str}, int @var{base}, zz_t *@var{u})
Set @var{u} from null-terminated string @var{str} of digits in the given
@var{base}.  The @var{base} may vary from 2 to 36, or if it's 0, then the
leading characters are used: "0x" for hexadecimal, "0b" for binary, "0o" for
octal, or decimal otherwise.

Case of digits is ignored.  Ascii letters represent values in range 10 to 35.
Digits can be preceded by '+' or '-' and be surrounded by whitespaces and have
single underscores interspersed between.
@end deftypefun

@node Converting Integers, Arithmetics on Integers, Assigning Integers, Functions
@section Conversion
@cindex Integer conversion functions
@cindex Conversion functions

@deftypefun zz_err zz_get_i32 (const zz_t *@var{u}, int32_t *@var{v})
@deftypefunx zz_err zz_get_i64 (const zz_t *@var{u}, int64_t *@var{v})
@deftypefunx zz_err zz_get_u32 (const zz_t *@var{u}, uint32_t *@var{v})
@deftypefunx zz_err zz_get_u64 (const zz_t *@var{u}, uint64_t *@var{v})
@deftypefunx zz_err zz_get_double (const zz_t *@var{u}, double *@var{v})
Convert @var{u} to @var{v}.  Available as @code{zz_get} macro.  Return
@code{ZZ_BUF} on failure.

Only nonnegative @var{u} are acceptable for conversion to unsigned integer
types.

Conversion to double uses rounding to nearest, with the half to even
tie-breaking rounding rule (roundTiesToEven in IEEE 754, the default).
@end deftypefun

@deftypefun zz_err zz_get_str (const zz_t *@var{u}, int @var{base}, char *@var{str})
Convert @var{u} to null-terminated string @var{str} of digits in the given
@var{base}, which may vary from 2 to 36.  The @var{str} has to have enough
space, which can be estimated by @code{zz_sizeinbase(@var{u}, base)}.  Return
@code{ZZ_MEM} or @code{ZZ_VAL} on failure.
@end deftypefun

@node Arithmetics on Integers, Exponentiation, Converting Integers, Functions
@section Arithmetics
@cindex Arithmetics on Integers
@cindex Arithmetics

@deftypefun zz_err zz_add (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_add_i64 (const zz_t *@var{u}, int64_t @var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_add_u64 (const zz_t *@var{u}, uint64_t @var{v}, zz_t *@var{w})
Set @var{w} to @math{@var{u} + @var{v}}.  Available as @code{zz_add} macro.
@end deftypefun

@deftypefun zz_err zz_sub (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_sub_i64 (const zz_t *@var{u}, int64_t @var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_i64_sub (int64_t @var{u}, const zz_t *@var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_sub_u64 (const zz_t *@var{u}, uint64_t @var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_u64_sub (uint64_t @var{u}, const zz_t *@var{v}, zz_t *@var{w})
Set @var{w} to @math{@var{u} - @var{v}}.  Available as @code{zz_sub} macro.
@end deftypefun

@deftypefun zz_err zz_pos (const zz_t *@var{u}, zz_t *@var{v})
Set @var{v} to @math{+@var{u}}, a copy of @var{u}.  Return @code{ZZ_MEM} on
failure.
@end deftypefun

@deftypefun zz_err zz_neg (const zz_t *@var{u}, zz_t *@var{v})
Set @var{v} to @math{-@var{u}}.  Return @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_abs (const zz_t *@var{u}, zz_t *@var{v})
Set @var{v} to the magnitude of @var{u}.  Return @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_mul (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_mul_i64 (const zz_t *@var{u}, int64_t @var{v}, zz_t *@var{w})
@deftypefunx zz_err zz_mul_u64 (const zz_t *@var{u}, uint64_t @var{v}, zz_t *@var{w})
Set @var{w} to @m{@var{u} \times @var{v}, @var{u} × @var{v}}.  Available
as @code{zz_mul} macro.
@end deftypefun

@deftypefun zz_err zz_mul_2exp (const zz_t *@var{u}, zz_bitcnt_t @var{v}, zz_t *@var{w})
Set @var{w} to @m{@var{u} \times 2^{@var{v}}, @var{u} × 2 raised to @var{v}}
(left shift by @var{v} bits).
@end deftypefun

@deftypefun zz_err zz_div (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{q}, zz_t *@var{r})
@deftypefunx zz_err zz_div_i64 (const zz_t *@var{u}, int64_t @var{v}, zz_t *@var{q}, zz_t *@var{r})
@deftypefunx zz_err zz_i64_div (int64_t @var{u}, const zz_t *@var{v}, zz_t *@var{q}, zz_t *@var{r})
Divide @var{u} by @var{v} and set the quotient @var{q} and the remainder
@var{r}.  The quotient rounded down toward @m{-\infty, @minus{}infinity}, and
@var{r} will have the same sign as @var{v}.  Available as @code{zz_div} macro.

Both @var{q} and @var{r} can be set to @code{NULL}, if their value is not
required.  Only nonzero values are permitted for the divisor @var{v}.  Return
@code{ZZ_VAL} or @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_quo_2exp (const zz_t *@var{u}, zz_bitcnt_t @var{v}, zz_t *@var{w})
Set @var{w} to quotent of @var{u} and @m{2^{@var{v}}, 2 raised to @var{v}}
(right shift by @var{v} bits).  Rounding is same as for @code{zz_div}.  Return
@code{ZZ_MEM} on failure.
@end deftypefun

@node Exponentiation, Comparison Functions, Arithmetics on Integers, Functions
@section Exponentiation
@cindex Integer exponentiation functions
@cindex Exponentiation functions

@deftypefun zz_err zz_pow (const zz_t *@var{u}, uint64_t @var{v}, zz_t *@var{w})
Set @var{w} to @m{@var{u}^{@var{v}},@var{u} raised to @var{v}}.
@end deftypefun

@deftypefun zz_err zz_powm (const zz_t *@var{u}, const zz_t *@var{v}, const zz_t *@var{w}, zz_t *@var{x})
Set @var{x} to @m{@var{u}^{@var{v}} @bmod @var{w},@var{u} raised to @var{v}
modulo @var{w}}.  Negative @var{v} are permitted if @var{u} has an inverse
modulo @var{w}.  The @var{w} expected to be nonzero.  Return @code{ZZ_VAL} or
@code{ZZ_MEM} on failure.
@end deftypefun

@node Comparison Functions, Logical Functions, Exponentiation, Functions
@section Comparisons
@cindex Integer comparison functions
@cindex Comparison functions

The following comparison results are supported as possible
values for the data type @code{zz_ord}:

@itemize @bullet
@item @code{ZZ_GT}: Left operand is greater then right.
@item @code{ZZ_EQ}: Operands are equal.
@item @code{ZZ_LT}: Left openrand is less then right.
@end itemize

@deftypefun zz_ord zz_cmp (const zz_t *@var{u}, const zz_t *@var{v})
@deftypefunx zz_ord zz_cmp_i64 (const zz_t *@var{u}, int64_t @var{v})
Compare @var{u} and @var{v}.  Available as @code{zz_cmp} macro.
@end deftypefun

@node Logical Functions, Number Theoretic Functions, Comparison Functions, Functions
@section Logical Functions
@cindex Integer logical functions
@cindex Logical functions

These functions behave as if twos complement arithmetic were used.

@deftypefun zz_err zz_invert (const zz_t *@var{u}, zz_t *@var{v})
Set @var{v} to the ones complement of @var{u}.
@end deftypefun

@deftypefun zz_err zz_and (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
Set @var{w} to @var{u} bitwise-and @var{v}.
@end deftypefun

@deftypefun zz_err zz_or (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
Set @var{w} to @var{u} bitwise-or @var{v}.
@end deftypefun

@deftypefun zz_err zz_xor (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
Set @var{w} to @var{u} bitwise exclusive-or @var{v}.
@end deftypefun

@node Number Theoretic Functions, Combinatorics, Logical Functions, Functions
@section Number Theoretic Functions
@cindex Number theoretic functions

@deftypefun zz_err zz_sqrtrem (const zz_t *@var{u}, zz_t *@var{v}, zz_t *@var{w})
Set @var{v} to @m{\lfloor\sqrt{@var{u}}\rfloor,the truncated integer part of
the square root of @var{u}}, the @var{u} expected to be nonnegative.  If
@var{w} is not @code{NULL}, set it to the remainder @m{@var{u}-@var{v}^2,
@var{u} - @var{v}*@var{v}}.  Return @code{ZZ_VAL} or @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_gcdext (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{g}, zz_t *@var{s}, zz_t *@var{t})
Set @var{g} to the greatest common divisor of @var{u} and @var{v}, and set
@var{s} and @var{t} to coefficients, satisfying
@math{@var{u}@var{s}+@var{v}@var{t}=@var{g}}.

The @var{g} is either positive or zero, if both @var{u} and @var{v} are zero.
The coefficients @var{s} and @var{t} are same as for the extended
Euclidean algorithm.

Any output parameter can be set to @code{NULL}, if its value not required.
Return @code{ZZ_MEM} on failure.
@end deftypefun

@deftypefun zz_err zz_lcm (const zz_t *@var{u}, const zz_t *@var{v}, zz_t *@var{w})
Set @var{w} to the least common multiple of @var{u} and @var{v}.  @var{w} is
positive or zero, if either @var{u} or @var{v} are zero.
@end deftypefun

@node Combinatorics, Import and Export, Number Theoretic Functions, Functions
@section Combinatorics

@deftypefun zz_err zz_fac (uint64_t @var{u}, zz_t *@var{v})
Set @var{v} to @math{@var{u}!}.

The @var{u} expected to be less or equal than @code{ULONG_MAX}.
@end deftypefun

@deftypefun zz_err zz_bin (uint64_t @var{n}, uint64_t @var{k}, zz_t *@var{v})
Set @var{v} to the binomial coefficient @m{\left({n}\atop{k}\right),@var{n}
over @var{k}}.

@var{n} and @var{k} expected to be less or equal than @code{ULONG_MAX}.
@end deftypefun

@node Import and Export, Miscellaneous Functions, Combinatorics, Functions
@section Import and Export
@cindex Import and export of integers
@cindex Import and export

The layout of big integer representation as an array of digits can be specified
by the type @code{zz_layout} with following fields:

@itemize @bullet
@item @code{bits_per_digit}: number of bits per digit.
@item @code{digit_size}: digit size in bytes.
@item @code{digits_order}: order of digits, either 1 for most significant digit
      first or -1 for last.
@item @code{digit_endianness}: digit endianness, either 1 for MSB, or -1
      for LSB, or 0 for platforms endianness.
@end itemize

@deftypefun const zz_layout * zz_get_layout (void)
Get native layout for the library.
@end deftypefun

@deftypefun zz_err zz_import (size_t @var{len}, const void *@var{data}, zz_layout @var{layout}, zz_t *@var{u})
Set magnitude of @var{u} from @var{data} array of size @var{len} in the
specified @var{layout}.
@end deftypefun

@deftypefun zz_err zz_export (const zz_t *@var{u}, zz_layout @var{layout}, size_t @var{len}, void *@var{data})
Export magnitude of @var{u} as pre-allocated @var{data} array of size @var{len}
in the specified @var{layout}.  Return @code{ZZ_BUF} on failure.
@end deftypefun

@node Miscellaneous Functions, References, Import and Export, Functions
@section Miscellaneous
@cindex Miscellaneous functions

@deftypefun zz_err zz_sizeinbase (const zz_t *@var{u}, int @var{base}, size_t *@var{size})
Return the @var{size} of @var{u} magnitude, measured in number of digits in the
given @var{base}.  The absolute value of @var{base} might vary from 2 to 36.
The @var{size} will be either exact or 1 too big.  If @var{base} is a power of
2, its always exact.  Return @code{ZZ_VAL} on failure.
@end deftypefun

@deftypefun zz_bitcnt_t zz_bitlen (const zz_t *@var{u})
Return the number of bits necessary to represent @var{u} magnitude in binary.
@end deftypefun

@deftypefun zz_bitcnt_t zz_lsbpos (const zz_t *@var{u})
Return the position of the lowest bit set of @var{u} magnitude in binary.
@end deftypefun

@deftypefun zz_bitcnt_t zz_bitcnt (const zz_t *@var{u})
Return the population count of @var{u} magnitude in binary.
@end deftypefun

@deftypefun bool zz_iszero (const zz_t *@var{u})
@deftypefunx bool zz_isneg (const zz_t *@var{u})
@deftypefunx bool zz_isodd (const zz_t *@var{u})
Determine whether @var{u} is zero, negative or odd.
@end deftypefun

@deftypefun const char * zz_get_version (void)
Get the ZZ version number, as a null-terminated string, in the form ``i.j.k''.
@end deftypefun

@deftypefun zz_bitcnt_t zz_get_bitcnt_max (void)
Get maximal count of bits for the magnitude of a big integer.
@end deftypefun

@node References, GNU Free Documentation License, Functions, Top
@chapter References

@itemize @bullet
@item
Torbj@"orn Granlund, "GNU MP: The GNU Multiple Precision Arithmetic Library",
version 6.3.0, 29 July 2016, @url{https://gmplib.org/}.

@end itemize

@node GNU Free Documentation License, Function Index, References, Top
@unnumbered GNU Free Documentation License
@include fdl.texi

@node Function Index, Variable Index, GNU Free Documentation License, Top
@unnumbered Function Index

@printindex fn

@node Variable Index, Type Index, Function Index, Top
@unnumbered Variable Index

@printindex vr

@node Type Index, Concept Index, Variable Index, Top
@unnumbered Type Index

@printindex tp

@node Concept Index,  , Type Index, Top
@unnumbered Concept Index

@printindex cp
@bye
